extends ../mixins/layout

block title
  title #{exercise.name} - Code Wars

block header
  +header()

block body
  +flash
  .container
    form.single-mission-detail(action=action  method="post" enctype="multipart/form-data")
      input(type="hidden" name="exerciseName" value=exercise.name)
      h1#mission-title=exercise.name
      hr.separator
      h3.mb-2 Débriefing de la mission
      p.mission-description=exercise.description
        .mission-info.px-0
          .row.mission-week
            .col-2.mb-0
              i.fas.fa-calendar-alt
            .col-8.mb-0
              span Semaine #{exercise.week_id}
          .row.mission-cash-reward
            .col-2.mb-0
              img(src="/assets/images/credit_symbol.svg").svg-icons
            .col-8.mb-0
              span #{format('decimal', exercise.cash_reward, 0, 0)}
          .row.mission-point-reward
            .col-2.mb-0
              img.m-1(src="/assets/images/ethereum_symbol.svg").svg-icons
            .col-8.mb-0
              span #{format('decimal', exercise.point_reward, 0, 0)}
          .row.mission-state
            if corrected
              .col-2.mb-0
                i.far.fa-check-circle.corrected
              .col-8.mb-0
                span.font-weight-light Corrigé
            else if !submitted
              .col-2.mb-0
                i.far.fa-times-circle.not-submitted
              .col-8.mb-0
                span.font-weight-light Non-remis
            else
              .col-2.mb-0
                i.far.fa-check-circle.submitted
              .col-8.mb-0
                span Remis
          .col-12.mission-difficulty-container.mb-1
            span Achèvement
            h6.text-muted=completion + " % des élèves ont complétés l'exercises"
          .col-8.mission-difficulty-container
            span Difficulté
            .difficulty-stars
                - var i = 0
                - var difficultyDifference = 5 - exercise.difficulty;
            while i < exercise.difficulty
              i.fas.fa-star.active
              - i++
              - var i = 0
            while i < difficultyDifference
              i.fas.fa-star
              - i++
        div.mission-execution-example
          h3 Exemple d'exécution
          pre=exercise.execution_exemple
        .mission-tips.mt-4
          h3 Indices de mission
              each tip in tips
                .row
                  .col-8.d-flex.align-items-center
                    p=tip.tip
                  .col-4.d-flex.justify-content-end
                    if !tip.bought
                      form(action="/exercises/tips/" + tip.id + "/buy" method="post")
                        button.btn.btn-yellow
                          +star_wars_money(tip.price)

      if !corrected
        div.mission-submit.m-4
          a(href="/exercises/submit/" + exercise.id)
            if (student.team_name === "Sith")
              img.submit-team(src="/assets/images/sith.png")
            else if (student.team_name === "Rebel")
              img.submit-team(src="/assets/images/rebel.png")
            else
              img.submit-team(src="/assets/images/dark_vador.png")
            span Soumettre un solution
      else
        div.mission-submit.disabled.m-4
          if (student.team_name === "Sith")
            img.submit-team(src="/assets/images/sith.png")
          else if (student.team_name === "Rebel")
            img.submit-team(src="/assets/images/rebel.png")
          else
            img.submit-team(src="/assets/images/dark_vador.png")
          span Corrigé

block script
  script(src='/javascripts/vendor/jquery-3.5.1.min.js')
  script(src='/javascripts/upload.js')
